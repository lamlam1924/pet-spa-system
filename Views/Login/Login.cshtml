@model pet_spa_system1.ViewModel.LoginRegisterViewModel

<!DOCTYPE html>
<html class="no-js" lang="zxx">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=esdge">
    <title>Animal</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- <link rel="manifest" href="site.webmanifest"> -->
    <link rel="shortcut icon" type="image/x-icon" href="@Url.Content("~/img/Picture5.png")">
    <!-- Place favicon.ico in the root directory -->
    <!-- CSS here -->
    <link rel="stylesheet" href="@Url.Content("~/css/bootstrap.min.css")">
    <link rel="stylesheet" href="@Url.Content("~/css/owl.carousel.min.css")">
    <link rel="stylesheet" href="@Url.Content("~/css/magnific-popup.css")">
    <!-- Font Awesome CDN for full icon support -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <link rel="stylesheet" href="@Url.Content("~/css/font-awesome.min.css")">
    <link rel="stylesheet" href="@Url.Content("~/css/themify-icons.css")">
    <link rel="stylesheet" href="@Url.Content("~/css/nice-select.css")">
    <link rel="stylesheet" href="@Url.Content("~/css/flaticon.css")">
    <link rel="stylesheet" href="@Url.Content("~/css/gijgo.css")">
    <link rel="stylesheet" href="@Url.Content("~/css/animate.css")">
    <link rel="stylesheet" href="@Url.Content("~/css/slicknav.css")">
    <link rel="stylesheet" href="@Url.Content("~/css/style.css")">
    <link rel="stylesheet" href="@Url.Content("~/css/responsive.css")">

    <link rel="stylesheet" href="@Url.Content("~/css/login.css")">
    <style>
        /* Ép modal nằm trên tất cả */
        .modal {
            z-index: 2000 !important;
        }

        .modal-backdrop {
            z-index: 1050 !important;
        }

        /* Giảm z-index container-login nếu nó đang cao */
        .container-login {
            position: relative;
            z-index: 1 !important;
        }

    </style>

</head>


<body>


    <div class="body-login">

        <!-- <h2>Đăng Nhập/Đăng Ký</h2> -->
        <div class="container-login" id="container-login">

            <div class="form-container sign-up-container">

                <form class="form-login" asp-controller="Login" asp-action="Register" method="post">
                    <h1>Đăng Ký</h1>
                    <div class="social-container">
                        <a href="/login/google" class="social"><i class="fab fa-google-plus-g"></i></a>
                    </div>
                    <span>hoặc sử dụng email của bạn để đăng ký</span>
                    <input class="input-login" type="text" placeholder="Name" name="Register.Name" value="@Model.Register?.Name" />
                    <input class="input-login" type="email" placeholder="Email" name="Register.Email" value="@Model.Register?.Email" />
                    <input class="input-login" type="password" placeholder="Password" name="Register.Password" />
                    <button type="submit">Đăng Ký</button>
                </form>
            </div>
            <div class="form-container sign-in-container">
                <form class="form-login" asp-controller="Login" asp-action="Login" method="post">
                    <h1>Đăng Nhập</h1>
                    <div class="social-container">
                        <a href="/login/google" class="social"><i class="fab fa-google-plus-g"></i></a>
                    </div>
                    <span>hoặc sử dụng tài khoản của bạn</span>
                    <input class="input-login" type="email" placeholder="Email" name="Login.Email" value="@Model.Login?.Email" />
                    <input class="input-login" type="password" placeholder="Password" name="Login.Password" />
                    <div style="display: flex; align-items: center;">
                        <label style="margin: 0; display: flex; align-items: center;">
                            <input type="checkbox" style="margin-right: 5px;" name="Login.RememberMe" /> Duy trì đăng nhập
                        </label>
                    </div>
                    <div style="text-align: right; margin-bottom: 10px;">
                        <a href="#" data-bs-toggle="modal" data-bs-target="#forgotPasswordModal">Quên mật khẩu?</a>
                    </div>
                    <button type="submit">Đăng Nhập</button>
                </form>
            </div>
            <div class="overlay-container1">
                <div class="overlay1">
                    <div class="overlay-panel overlay-left">
                        <h1>Chào mừng trở lại!</h1>
                        <p>Để tiếp tục kết nối với chúng tôi, vui lòng đăng nhập bằng thông tin cá nhân của bạn</p>
                        <button class="ghost" id="signIn">Đăng Nhập</button>
                    </div>
                    <div class="overlay-panel overlay-right">
                        <h1>Xin chào, bạn!</h1>
                        <p>Nhập thông tin cá nhân của bạn và bắt đầu hành trình với chúng tôi</p>
                        <button class="ghost" id="signUp">Đăng Ký</button>
                    </div>
                </div>
            </div>
        </div>
        <script>
            const signUpButton = document.getElementById('signUp');
            const signInButton = document.getElementById('signIn');
            const container = document.getElementById('container-login');

            signUpButton.addEventListener('click', () => {
                container.classList.add('right-panel-active');
            });

            signInButton.addEventListener('click', () => {
                container.classList.remove('right-panel-active');
            });
        </script>
        <div class="modal fade" id="forgotPasswordModal" tabindex="-1" aria-labelledby="forgotPasswordLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content p-3">
                    <div class="modal-header">
                        <h5 class="modal-title" id="forgotPasswordLabel">Quên mật khẩu</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Đóng"></button>
                    </div>

                    <!-- Step 1: Nhập Email -->
                    <div id="step1-email" class="modal-body">
                        <form asp-controller="Login" asp-action="ForgotPassword" method="post">
                            <div class="mb-3">
                                <label class="form-label">Email đã đăng ký</label>
                                <input type="email" class="form-control" name="Email" required placeholder="Nhập email của bạn">
                            </div>
                            <button type="submit" class="btn btn-primary w-100">Gửi mã OTP</button>
                        </form>
                    </div>

                    <!-- Step 2: Nhập OTP -->
                    <div id="step2-otp" class="modal-body d-none">
                        <form asp-controller="Login" asp-action="VerifyOtpAndResetPassword" method="post" onsubmit="return validatePasswords()">
                            <input type="hidden" name="Email" id="otp-email" />

                            <div class="mb-3">
                                <label class="form-label">Mã OTP</label>
                                <input type="text" class="form-control" name="OtpCode" required placeholder="Nhập mã OTP">
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Mật khẩu mới</label>
                                <input type="password" class="form-control" id="newPassword" name="NewPassword" required placeholder="Nhập mật khẩu mới">
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Xác nhận mật khẩu mới</label>
                                <input type="password" class="form-control" id="confirmPassword" name="ConfirmPassword" required placeholder="Nhập lại mật khẩu mới">
                            </div>

                            <div class="text-danger" id="passwordError" style="display:none;">Mật khẩu xác nhận không khớp</div>

                            <button type="submit" class="btn btn-success w-100">Đặt lại mật khẩu</button>
                        </form>
                    </div>


                </div>
            </div>
        </div>


    </div>
    <script>
        // Giả sử sau khi gửi email xong, server render lại modal với TempData/flag hoặc JS gọi API thành công
        function showOtpStep(email) {
            document.getElementById("step1-email").classList.add("d-none");
            document.getElementById("step2-otp").classList.remove("d-none");
            document.getElementById("otp-email").value = email; // gán email cho hidden field
        }

        // Gọi hàm này khi xử lý thành công gửi email (nếu dùng AJAX thì gọi trực tiếp)
    </script>
    <script>
        function validatePasswords() {
            var password = document.getElementById('newPassword').value;
            var confirmPassword = document.getElementById('confirmPassword').value;
            var errorDiv = document.getElementById('passwordError');

            if (password !== confirmPassword) {
                errorDiv.style.display = "block";
                return false; // chặn submit
            }

            errorDiv.style.display = "none";
            return true; // cho phép submit
        }
    </script>

    <script>
        window.addEventListener('load', function () {
            @if (ViewBag.ShowModal?.ToString() == "forgot" || ViewBag.ShowStep2 != null)
            {
                    <text>
                        var forgotModal = new bootstrap.Modal(document.getElementById('forgotPasswordModal'));
                        forgotModal.show();

                        @if (ViewBag.ShowStep2 != null)
                        {
                                <text>
                                    document.getElementById("step1-email").classList.add("d-none");
                                    document.getElementById("step2-otp").classList.remove("d-none");
                                    document.getElementById("otp-email").value = "@ViewBag.ResetEmail";
                                    console.log("Chuyển sang bước nhập OTP");
                                </text>
                        }
                    </text>
            }
        });
    </script>





    <!-- footer_end  -->
    <!-- JS here -->
    <!-- Bắt buộc để modal hoạt động -->
    @* <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script> *@

    <script src="@Url.Content("~/js/vendor/modernizr-3.5.0.min.js")"></script>
    <script src="@Url.Content("~/js/vendor/jquery-1.12.4.min.js")"></script>
    <script src="@Url.Content("~/js/popper.min.js")"></script>
    <script src="@Url.Content("~/js/bootstrap.min.js")"></script>
    <script src="@Url.Content("~/js/owl.carousel.min.js")"></script>
    <script src="@Url.Content("~/js/isotope.pkgd.min.js")"></script>
    <script src="@Url.Content("~/js/ajax-form.js")"></script>
    <script src="@Url.Content("~/js/waypoints.min.js")"></script>
    <script src="@Url.Content("~/js/jquery.counterup.min.js")"></script>
    <script src="@Url.Content("~/js/imagesloaded.pkgd.min.js")"></script>
    <script src="@Url.Content("~/js/scrollIt.js")"></script>
    <script src="@Url.Content("~/js/jquery.scrollUp.min.js")"></script>
    <script src="@Url.Content("~/js/wow.min.js")"></script>
    <script src="@Url.Content("~/js/nice-select.min.js")"></script>
    <script src="@Url.Content("~/js/jquery.slicknav.min.js")"></script>
    <script src="@Url.Content("~/js/jquery.magnific-popup.min.js")"></script>
    <script src="@Url.Content("~/js/plugins.js")"></script>
    <script src="@Url.Content("~/js/gijgo.min.js")"></script>

    <!--contact js-->
    <script src="@Url.Content("~/js/contact.js")"></script>
    <script src="@Url.Content("~/js/jquery.ajaxchimp.min.js")"></script>
    <script src="@Url.Content("~/js/jquery.form.js")"></script>
    <script src="@Url.Content("~/js/jquery.validate.min.js")"></script>
    <script src="@Url.Content("~/js/mail-script.js")"></script>

    <script src="@Url.Content("~/js/main.js")"></script>
    <script>
           $('#datepicker').datepicker({
               iconsLibrary: 'fontawesome',
               disableDaysOfWeek: [0, 0],
           //     icons: {
           //      rightIcon: '<span class="fa fa-caret-down"></span>'
           //  }
           });
           $('#datepicker2').datepicker({
               iconsLibrary: 'fontawesome',
               icons: {
                rightIcon: '<span class="fa fa-caret-down"></span>'
            }

           });
           var timepicker = $('#timepicker').timepicker({
            format: 'HH.MM'
        });
    </script>


</body>

</html>
